image:
  name: zealic/docker
  entrypoint: ["sh", "-c"]
services:
  - name: docker:18.06-dind
    alias: docker
    command: [
      "--dns-search=lan"
    ]
variables:
  DOCKER_HOST: tcp://docker:2375
  # When using dind, it's wise to use the overlayfs driver for
  # improved performance.
  # See also: https://docs.gitlab.com/ce/ci/docker/using_docker_build.html
  DOCKER_DRIVER: overlay2

# global *_script will overwrite by job defined *_script
before_script:
  - |
    # Ensuring network...
    : DO NOTHING
  - eval "$(wget -qO- https://arp.to/@ci/scripts/before.sh)"
after_script:
  - eval "$(wget -qO- https://arp.to/@ci/scripts/after.sh)"
